<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ProductRank ì±Œë¦°ì§€ ë° ë­í¬ë³´ë“œ</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter í°íŠ¸ ì„¤ì • -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <!-- Lucide Icons (ë‹¬ë ¥, íˆ¬í‘œ, ëŒ“ê¸€ ì•„ì´ì½˜ ë“±ì„ ìœ„í•´ ì‚¬ìš©) -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f9;
        }
        /* Custom styles for the toggle button */
        .toggle-container {
            display: flex;
            background-color: #e5e7eb;
            border-radius: 9999px;
            padding: 2px;
            width: 140px;
        }
        .toggle-button {
            flex: 1;
            padding: 4px 10px;
            border-radius: 9999px;
            text-align: center;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            color: #4b5563; /* Gray text for inactive */
        }
        .toggle-button.active {
            background-color: #ffffff;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            color: #1f2937; /* Darker text for active */
        }
        /* Modal Backdrop */
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.4);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        /* Toast Notification Styling */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            z-index: 1050;
        }
        .toast.show {
            opacity: 1;
            visibility: visible;
        }

        /* Upvote animation (for feedback) */
        @keyframes upvote-flash {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        .upvote-flash {
            animation: upvote-flash 0.3s ease-out;
            color: #ef4444; /* Red color for emphasis */
        }
        
        /* ì œí’ˆ ì¹´ë“œì˜ ìˆ˜ì§ ê³µê°„ íš¨ìœ¨ì„ ìœ„í•œ íŒ¨ë”© ì¡°ì • */
        .product-card {
            padding: 16px; /* p-4 ìœ ì§€ */
        }

    </style>
</head>
<body class="p-4 md:p-8">

    <div id="app" class="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl p-6 md:p-8">
        <!-- Main Application Container -->
    </div>
    
    <!-- Modal Container for Date Picker -->
    <div id="date-picker-modal-root"></div>
    
    <!-- Toast Notification Container -->
    <div id="toast-root"></div>

    <script>
        // Lucide Icons ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
        });

        // =========================================================================
        // 1. Mock Data (ì œí’ˆ ì¹´ë“œì— í‘œì‹œë  ì„ì‹œ ë°ì´í„°)
        // =========================================================================
        let mockProducts = [
            // categoryë¥¼ ë°°ì—´ë¡œ ë³€ê²½ (ìµœëŒ€ 3ê°œ ë“±ë¡ ê°€ëŠ¥ì„± ë°˜ì˜)
            { id: 1, name: "Gemini Pro App", desc: "ì°¨ì„¸ëŒ€ AI ì—ì´ì „íŠ¸ ì„œë¹„ìŠ¤ë¡œ ì—…ë¬´ë¥¼ í˜ì‹ í•˜ì„¸ìš”.", logo: "ğŸ¤–", category: ["AI", "SaaS", "Productivity"], launchDate: "2025.11.20", votes: 952, comments: 124, rank: 1, status: 'ì›”ê°„ í›„ë³´êµ°' },
            { id: 2, name: "Design Flow", desc: "í˜‘ì—… ê°€ëŠ¥í•œ AI ê¸°ë°˜ ë””ìì¸ íˆ´ë¡œ ì†ë„ë¥¼ ë†’ì…ë‹ˆë‹¤.", logo: "ğŸ¨", category: ["SaaS", "Design"], launchDate: "2025.11.25", votes: 810, comments: 88, rank: 2, status: 'ì£¼ê°„ ì±Œë¦°ì§€ ì¤‘' },
            { id: 3, name: "FinTrack", desc: "ê°œì¸ ì¬ì •ì„ ìë™ìœ¼ë¡œ ë¶„ì„í•˜ê³  ë¦¬í¬íŠ¸í•©ë‹ˆë‹¤.", logo: "ğŸ’°", category: ["FinTech", "Personal Finance"], launchDate: "2025.12.01", votes: 540, comments: 55, rank: 3, status: 'ì¼ë°˜ ì œí’ˆ' },
            { id: 4, name: "Code Sprint", desc: "ê°œë°œ ì†ë„ë¥¼ 2ë°° ë†’ì´ëŠ” í˜‘ì—… ì½”ë“œ ë¦¬ë·° ì‹œìŠ¤í…œ.", logo: "ğŸ’»", category: ["ê°œë°œë„êµ¬", "DevOps"], launchDate: "2025.12.05", votes: 410, comments: 22, rank: 4, status: 'ì£¼ê°„ ì±Œë¦°ì§€ ì¤‘' },
            { id: 5, name: "Eco Planner", desc: "íƒ„ì†Œ ë°œìêµ­ì„ ì¶”ì í•˜ê³  ì¤„ì´ëŠ” ì§€ì†ê°€ëŠ¥ì„± ì•±.", logo: "ğŸŒ", category: ["ESG", "Lifestyle"], launchDate: "2025.10.15", votes: 305, comments: 15, rank: 5, status: 'ì¼ë°˜ ì œí’ˆ' },
        ];
        
        // í•„í„°ë§ì— ì‚¬ìš©í•  ì¹´í…Œê³ ë¦¬ ëª©ë¡
        const mockCategories = ["ì „ì²´", "AI", "SaaS", "FinTech", "ê°œë°œë„êµ¬", "ESG", "Design", "Productivity", "Personal Finance", "DevOps", "Lifestyle"];
        const mockSorts = ["ìµœì‹ ìˆœ", "íˆ¬í‘œìˆœ", "ëŒ“ê¸€ìˆœ"];

        // =========================================================================
        // 2. State Management (ìƒíƒœ ê´€ë¦¬)
        // =========================================================================
        let state = {
            activeTab: 'rankboard', // 'rankboard' or 'challenge'
            activePeriod: 'weekly', // 'weekly' or 'monthly'
            activeCategory: 'ì „ì²´',
            activeSort: 'ìµœì‹ ìˆœ', 
            isModalOpen: false, // ë‚ ì§œ ì„ íƒ ëª¨ë‹¬ ìƒíƒœ
        };

        // UIë¥¼ ë‹¤ì‹œ ê·¸ë¦¬ëŠ” í•¨ìˆ˜
        function render() {
            const app = document.getElementById('app');
            app.innerHTML = `
                ${renderTabs()}
                <div class="mt-6">
                    ${renderTabContent()}
                </div>
            `;
            
            // ëª¨ë‹¬ ë Œë”ë§ (ìƒíƒœì— ë”°ë¼)
            renderModal();

            // ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë‹¤ì‹œ ì—°ê²°
            attachEventListeners();
            lucide.createIcons();
        }

        // =========================================================================
        // 3. UI Components (ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ í•¨ìˆ˜)
        // =========================================================================

        // A. ë©”ì¸ íƒ­ (Tab Navigation)
        function renderTabs() {
            const activeClass = "border-indigo-600 text-indigo-700 font-bold";
            const inactiveClass = "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300";

            return `
                <div class="border-b border-gray-200">
                    <nav class="-mb-px flex space-x-8" aria-label="Tabs">
                        <button onclick="updateState('activeTab', 'rankboard')"
                            class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 text-lg transition-colors ${state.activeTab === 'rankboard' ? activeClass : inactiveClass}">
                            ğŸ† ë­í¬ë³´ë“œ (ê¸°ì¡´/í™•ì • ìˆœìœ„)
                        </button>
                        <button onclick="updateState('activeTab', 'challenge')"
                            class="tab-btn whitespace-nowrap py-3 px-1 border-b-2 text-lg transition-colors ${state.activeTab === 'challenge' ? activeClass : inactiveClass}">
                            ğŸš€ ì±Œë¦°ì§€ (ì‹ ê·œ/ì‹¤ì‹œê°„ ê²½ìŸ)
                        </button>
                    </nav>
                </div>
            `;
        }

        // B. ì¹´í…Œê³ ë¦¬ í•„í„° (ë“œë¡­ë‹¤ìš´ í˜•íƒœ)
        function renderCategoryFilter() {
            return `
                <div class="relative w-full md:w-44 flex-shrink-0">
                    <select onchange="updateState('activeCategory', this.value)"
                        class="block appearance-none w-full rounded-md border border-gray-300 bg-white py-2 pl-3 pr-10 text-sm font-medium text-gray-700 focus:border-indigo-500 focus:ring-indigo-500 transition-shadow cursor-pointer shadow-sm">
                        ${mockCategories.map(cat => {
                            // "ì „ì²´" ì¹´í…Œê³ ë¦¬ì—ë§Œ "ì¹´í…Œê³ ë¦¬:" ì ‘ë‘ì‚¬ ìœ ì§€
                            const displayCat = cat === 'ì „ì²´' ? `ì¹´í…Œê³ ë¦¬: ${cat}` : cat;
                            return `
                                <option value="${cat}" ${state.activeCategory === cat ? 'selected' : ''}>
                                    ${displayCat}
                                </option>
                            `;
                        }).join('')}
                    </select>
                    <!-- Custom Arrow Icon -->
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700">
                        <i data-lucide="chevron-down" class="w-4 h-4"></i>
                    </div>
                </div>
            `;
        }

        // C. ê¸°ê°„ í•„í„° (í† ê¸€ í˜•íƒœ)
        function renderPeriodFilter() {
            return `
                <div class="toggle-container">
                    <button onclick="updateState('activePeriod', 'weekly');" 
                            class="toggle-button ${state.activePeriod === 'weekly' ? 'active' : ''}">
                        ì£¼ê°„
                    </button>
                    <button onclick="updateState('activePeriod', 'monthly');" 
                            class="toggle-button ${state.activePeriod === 'monthly' ? 'active' : ''}">
                        ì›”ê°„
                    </button>
                </div>
            `;
        }

        // D. ì •ë ¬ í•„í„° (ì±Œë¦°ì§€ íƒ­ ì „ìš©)
        function renderSortFilter() {
            // ì •ë ¬ í•„í„°ë„ ê³µê°„ í™•ë³´ë¥¼ ìœ„í•´ í…ìŠ¤íŠ¸ í¬ê¸° ì¶•ì†Œ
            return `
                <div class="relative inline-block text-left">
                    <select onchange="updateState('activeSort', this.value)"
                        class="block w-full rounded-md border border-gray-300 bg-white py-2 pl-3 pr-10 text-sm focus:border-indigo-500 focus:ring-indigo-500 transition-shadow cursor-pointer">
                        ${mockSorts.map(sort => `
                            <option value="${sort}" ${state.activeSort === sort ? 'selected' : ''}>${sort}</option>
                        `).join('')}
                    </select>
                </div>
            `;
        }

        // E. ë‚ ì§œ/ìƒíƒœ í‘œì‹œ ì˜ì—­
        function renderStatusArea() {
            if (state.activeTab === 'rankboard') {
                // ë­í¬ë³´ë“œ: ë‚ ì§œ/ê¸°ê°„ ëª…ì‹œ ë° íƒìƒ‰ ë²„íŠ¼ + í´ë¦­ ì‹œ ë‹¬ë ¥ ëª¨ë‹¬ ë„ìš°ê¸°
                const dateText = state.activePeriod === 'weekly' 
                    ? `2025ë…„ 11ì›” 4ì£¼ì°¨` 
                    : `2025ë…„ 11ì›”`;

                // ë‚ ì§œ ì˜ì—­ì„ ê°ì‹¸ëŠ” divì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì¶”ê°€
                return `
                    <div class="flex items-center space-x-2 text-gray-700 text-sm font-medium">
                        <button class="text-gray-400 hover:text-gray-600 transition-colors" title="ì´ì „ ê¸°ê°„">
                            <i data-lucide="chevron-left" class="w-5 h-5"></i>
                        </button>
                        <span id="date-picker-trigger" class="text-sm md:text-base font-semibold whitespace-nowrap cursor-pointer hover:text-indigo-600 transition-colors">
                            ${dateText}
                        </span>
                        <button class="text-gray-400 hover:text-gray-600 transition-colors" title="ë‹¤ìŒ ê¸°ê°„">
                            <i data-lucide="chevron-right" class="w-5 h-5"></i>
                        </button>
                    </div>
                `;
            } else {
                // ì±Œë¦°ì§€: ì§„í–‰ ì¤‘ ìƒíƒœ ëª…ì‹œ (í™œì„±í™” ìƒíƒœ ê°•ì¡°)
                const statusText = state.activePeriod === 'weekly'
                    ? `ì´ë²ˆ ì£¼ ì±Œë¦°ì§€ ì§„í–‰ ì¤‘ Â· ë§ˆê°ê¹Œì§€ D-3`
                    : `ì´ë²ˆ ë‹¬ ì±Œë¦°ì§€ ì§„í–‰ ì¤‘`;
                
                return `
                    <div class="flex items-center space-x-2 text-sm md:text-base font-bold text-green-600 bg-green-100 px-3 py-1.5 rounded-full shadow-inner">
                        <i data-lucide="zap" class="w-4 h-4 fill-green-600 text-green-600"></i>
                        <span>${statusText}</span>
                    </div>
                `;
            }
        }

        // F. ì œí’ˆ ì¹´ë“œ (ê°€ë¡œí˜• ë°•ìŠ¤)
        function renderProductCard(product, index) {
            const isRankboard = state.activeTab === 'rankboard';
            const rank = index + 1; // 1-based index for mock rank
            
            // ìƒíƒœ ë¼ë²¨ì€ ì±Œë¦°ì§€ íƒ­ì—ì„œë§Œ ì¡°ê±´ë¶€ë¡œ ì‚¬ìš©
            let statusColor = 'bg-blue-100 text-blue-800';
            let statusText = 'ì¼ë°˜ ì œí’ˆ';

            if (!isRankboard) {
                if (product.status === 'ì£¼ê°„ ì±Œë¦°ì§€ ì¤‘') {
                    statusColor = 'bg-green-100 text-green-800';
                    statusText = 'ì£¼ê°„ ì±Œë¦°ì§€ ì§„í–‰ Â· ë§ˆê° D-3';
                } else if (product.status === 'ì›”ê°„ í›„ë³´êµ°') {
                    statusColor = 'bg-yellow-100 text-yellow-800';
                    statusText = 'ì›”ê°„ ë­í¬ë³´ë“œ í›„ë³´ Â· ê²½ìŸ ì¤‘';
                }
            }
            
            // ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ (Lucide Icons ì‚¬ìš©)
            const upvoteIcon = `<i id="upvote-icon-${product.id}" data-lucide="arrow-up" class="w-4 h-4 text-red-500"></i>`;
            const commentIcon = '<i data-lucide="message-square" class="w-4 h-4 text-gray-500"></i>';

            return `
                <div class="product-card flex items-center p-4 bg-white border border-gray-200 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300">
                    
                    <!-- ë­í¬ë³´ë“œ: ìˆœìœ„ í‘œì‹œ -->
                    ${isRankboard ? `
                        <div class="w-12 text-center text-3xl font-extrabold text-indigo-600 mr-4 flex-shrink-0">
                            #${rank}
                        </div>
                    ` : ''}

                    <!-- ì œí’ˆ ë¡œê³  ë° ê¸°ë³¸ ì •ë³´ (flex-grow) -->
                    <div class="flex-grow flex items-start space-x-4">
                        <!-- ë¡œê³  (Emoji Placeholder) -->
                        <div class="flex-shrink-0 text-3xl p-2 bg-gray-50 rounded-lg border border-gray-100">
                            ${product.logo}
                        </div>
                        
                        <!-- ì œí’ˆ í…ìŠ¤íŠ¸ ì •ë³´ -->
                        <div class="min-w-0 flex-1 space-y-1"> <!-- ê³µê°„ íš¨ìœ¨ì„ ìœ„í•´ space-y-1 ì ìš© -->
                            <div class="flex flex-col md:flex-row md:items-center md:space-x-2">
                                <h3 class="text-xl font-bold text-gray-900 truncate">${product.name}</h3>
                                <!-- ì¹´í…Œê³ ë¦¬ ë³µìˆ˜ ë“±ë¡ ë°˜ì˜ -->
                                <div class="flex space-x-1 overflow-x-auto py-0.5 mt-1 md:mt-0">
                                    ${product.category.map(cat => `
                                        <span class="flex-shrink-0 text-xs font-medium text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full">${cat}</span>
                                    `).join('')}
                                </div>
                            </div>
                            <p class="text-sm text-gray-500 truncate">${product.desc}</p>
                            <p class="text-xs text-gray-400">ëŸ°ì¹­ì¼: ${product.launchDate}</p>
                        </div>
                    </div>

                    <!-- íˆ¬í‘œ/ëŒ“ê¸€ ì •ë³´ ë° ì•¡ì…˜ ê·¸ë£¹ (flex-shrink-0) -->
                    <div class="flex-shrink-0 ml-4 flex flex-col items-end space-y-2"> <!-- ìƒí•˜ ê³µê°„ í™•ë³´ -->
                        
                        <!-- 1. ì•¡ì…˜/ì ìˆ˜ ê·¸ë£¹ (ìˆ˜í‰ ì •ë ¬: íˆ¬í‘œ ë²„íŠ¼ + ìŠ¤íƒ¯) -->
                        <div class="flex items-center space-x-4">
                            
                            <!-- íˆ¬í‘œí•˜ê¸° ë²„íŠ¼ (ì±Œë¦°ì§€ íƒ­ì—ì„œë§Œ í‘œì‹œ, ì™¼ìª½ì— ë°°ì¹˜) -->
                            ${!isRankboard ? `
                                <button onclick="handleVoteClick(${product.id})" class="bg-indigo-600 text-white text-sm font-semibold px-3 py-1.5 rounded-lg hover:bg-indigo-700 transition-colors shadow-md whitespace-nowrap">
                                    íˆ¬í‘œí•˜ê¸°
                                </button>
                            ` : ''}
                            
                            <!-- íˆ¬í‘œ ë° ëŒ“ê¸€ ì•„ì´ì½˜ ê·¸ë£¹ (ìŠ¤íƒ¯, ìˆ˜í‰ ì •ë ¬) -->
                            <div class="flex space-x-3 items-center">
                                <!-- íˆ¬í‘œ/ì ìˆ˜ -->
                                <div id="vote-score-group-${product.id}" 
                                    class="flex items-center space-x-1 cursor-${!isRankboard ? 'pointer' : 'default'}"
                                    ${!isRankboard ? `onclick="handleVoteClick(${product.id})"` : ''}
                                >
                                    ${upvoteIcon}
                                    <span id="vote-count-${product.id}" class="text-sm font-semibold text-gray-800">${product.votes.toLocaleString()}</span>
                                </div>

                                <!-- ëŒ“ê¸€ -->
                                <div class="flex items-center space-x-1">
                                    ${commentIcon}
                                    <span class="text-sm font-semibold text-gray-800">${product.comments.toLocaleString()}</span>
                                </div>
                            </div>

                        </div>

                        <!-- 2. ìƒíƒœ ë¼ë²¨ (ì•„ë˜ì— ë°°ì¹˜) -->
                        ${!isRankboard && product.status !== 'ì¼ë°˜ ì œí’ˆ' ? `
                            <span class="text-xs font-semibold px-2 py-0.5 rounded-full ${statusColor} whitespace-nowrap">
                                ${statusText}
                            </span>
                        ` : `<div class="h-5"></div>`} <!-- ë†’ì´ ìœ ì§€ -->
                    </div>
                </div>
            `;
        }

        // íƒ­ ì»¨í…ì¸  (í•„í„° ë° ì œí’ˆ ëª©ë¡)
        function renderTabContent() {
            const isRankboard = state.activeTab === 'rankboard';

            // í•„í„°ë§ ë° ì •ë ¬ ë¡œì§ (Mock)
            let filteredProducts = mockProducts.filter(p => {
                // ì¹´í…Œê³ ë¦¬ í•„í„°ë§: ì œí’ˆì˜ ì¹´í…Œê³ ë¦¬ ë°°ì—´ì— ì„ íƒëœ ì¹´í…Œê³ ë¦¬ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
                return state.activeCategory === 'ì „ì²´' || p.category.includes(state.activeCategory);
            });

            // ì±Œë¦°ì§€ íƒ­ ì •ë ¬ ë¡œì§ (Mock)
            if (!isRankboard) {
                if (state.activeSort === 'íˆ¬í‘œìˆœ') {
                    filteredProducts.sort((a, b) => b.votes - a.votes);
                } else if (state.activeSort === 'ìµœì‹ ìˆœ') {
                    // Launch date comparison (simple string comparison for mock)
                    filteredProducts.sort((a, b) => new Date(b.launchDate) - new Date(a.launchDate));
                }
                // ëŒ“ê¸€ìˆœì€ Mockì´ë¯€ë¡œ íˆ¬í‘œìˆœê³¼ ë™ì¼í•˜ê²Œ ì²˜ë¦¬
            }
            
            return `
                <div class="space-y-6">
                    <!-- í—¤ë” ì„¤ëª… í…ìŠ¤íŠ¸ -->
                    <p class="text-lg text-gray-600 mt-2 mb-4">
                        ${isRankboard 
                            ? "ëª…ì˜ˆë¡œìš´ ì œí’ˆë“¤ì˜ ì—­ì‚¬ê°€ ì´ê³³ì— ê¸°ë¡ë©ë‹ˆë‹¤." // ë­í¬ë³´ë“œ ì„¤ëª…
                            : "ì´ë²ˆ ì£¼ ì‹ ê·œ ëŸ°ì¹­ ì œí’ˆë“¤ì´ ì‹¤ì‹œê°„ ê²½ìŸ ì¤‘ì…ë‹ˆë‹¤. ì§€ê¸ˆ íˆ¬í‘œí•´ì„œ 1ìœ„ë¥¼ ê²°ì •í•˜ì„¸ìš”." // ì±Œë¦°ì§€ ì„¤ëª… (ë³€ê²½ ë°˜ì˜ë¨)
                        }
                    </p>

                    <!-- í•„í„° ì˜ì—­ (3ê°œ ìš”ì†Œ í•œ ì¤„ì— ë°°ì¹˜) -->
                    <div class="bg-gray-50 p-4 rounded-lg shadow-inner">
                        
                        <!-- ê¸°ê°„ í•„í„°, ì¹´í…Œê³ ë¦¬ í•„í„°, ìƒíƒœ/ì •ë ¬ í•„í„°ë¥¼ ëª¨ë‘ í•œ ì¤„ì— ë°°ì¹˜ (md: ì´ìƒì—ì„œ) -->
                        <div class="flex flex-col md:flex-row md:items-center justify-between space-y-3 md:space-y-0">
                            
                            <!-- ì™¼ìª½ ê·¸ë£¹: ê¸°ê°„ í† ê¸€ & ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ -->
                            <div class="flex items-center space-x-4 flex-wrap md:flex-nowrap space-y-3 md:space-y-0">
                                ${renderPeriodFilter()}
                                ${renderCategoryFilter()} 
                            </div>

                            <!-- ì˜¤ë¥¸ìª½ ê·¸ë£¹: ì •ë ¬ í•„í„° (ì±Œë¦°ì§€) ë˜ëŠ” ë‚ ì§œ/ìƒíƒœ í‘œì‹œ (ë­í¬ë³´ë“œ) -->
                            <div class="flex items-center space-x-4 flex-shrink-0">
                                ${!isRankboard ? renderSortFilter() : ''}
                                ${renderStatusArea()}
                            </div>
                        </div>

                    </div>

                    <!-- ì œí’ˆ ëª©ë¡ -->
                    <div class="mt-8 space-y-4">
                        ${filteredProducts.length > 0 
                            ? filteredProducts.map((p, i) => renderProductCard(p, i)).join('')
                            : `<div class="text-center py-10 text-gray-500 text-xl bg-gray-100 rounded-xl">ì„ íƒëœ í•„í„°ì˜ ì œí’ˆì´ ì—†ìŠµë‹ˆë‹¤.</div>`
                        }
                    </div>
                </div>
            `;
        }
        
        // G. ë‚ ì§œ ì„ íƒ ëª¨ë‹¬ (ê°€ìƒ ë‹¬ë ¥)
        function renderModal() {
            const modalRoot = document.getElementById('date-picker-modal-root');
            if (!state.isModalOpen) {
                modalRoot.innerHTML = '';
                return;
            }

            const periodText = state.activePeriod === 'weekly' ? 'ì£¼ê°„' : 'ì›”ê°„';

            modalRoot.innerHTML = `
                <div class="modal-backdrop" onclick="closeModal()">
                    <div class="bg-white rounded-xl shadow-2xl p-6 w-80 max-w-full" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold text-gray-800">${periodText} ë­í‚¹ ê¸°ë¡ ì„ íƒ</h3>
                            <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600">
                                <i data-lucide="x" class="w-6 h-6"></i>
                            </button>
                        </div>
                        
                        <!-- ê°€ìƒì˜ ë‹¬ë ¥ UI -->
                        <div class="text-center">
                            <div class="flex justify-between items-center mb-3">
                                <button class="text-gray-500 hover:text-indigo-600"><i data-lucide="chevron-left" class="w-5 h-5"></i></button>
                                <span class="font-semibold text-lg">2025ë…„ 11ì›”</span>
                                <button class="text-gray-500 hover:text-indigo-600"><i data-lucide="chevron-right" class="w-5 h-5"></i></button>
                            </div>
                            
                            <p class="text-sm text-gray-500 mb-4">${periodText} ë‹¨ìœ„ë¡œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                            
                            <div class="grid grid-cols-7 gap-1 text-sm">
                                ${['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '].map(d => `<div class="font-bold text-gray-500">${d}</div>`).join('')}
                                <!-- ê°€ìƒì˜ ë‚ ì§œ ë²„íŠ¼ -->
                                ${Array(3).fill('<div class="p-2"></div>').join('')}
                                ${Array(30).fill(0).map((_, i) => {
                                    const day = i + 1;
                                    const isSelected = day >= 24 && day <= 30 && state.activePeriod === 'weekly';
                                    const dayClass = isSelected 
                                        ? 'bg-indigo-600 text-white font-bold rounded-md' 
                                        : 'bg-white text-gray-800 hover:bg-indigo-50 rounded-md';
                                    
                                    // ì£¼ê°„ ì„ íƒ ëª¨ë“œì¼ ë•Œ 4ì£¼ì°¨ë¥¼ ì„ íƒëœ ê²ƒìœ¼ë¡œ ê°€ì •
                                    if (state.activePeriod === 'weekly' && day % 7 === 4) {
                                        return `<div class="p-2 cursor-pointer transition-colors ${dayClass} col-span-1 border border-indigo-300">4ì£¼ì°¨</div>`;
                                    } else if (state.activePeriod === 'weekly' && day % 7 !== 4) {
                                        return `<div class="p-2 text-gray-300"></div>`; // ì£¼ê°„ ëª¨ë“œì—ì„œëŠ” ì£¼ì°¨ ë‹¨ìœ„ë¡œë§Œ í‘œì‹œ
                                    }

                                    return `<div class="p-2 cursor-pointer transition-colors ${dayClass}">${day}</div>`;
                                }).join('')}
                            </div>
                            
                            <button onclick="closeModal()" class="mt-6 bg-indigo-600 text-white font-semibold w-full py-2 rounded-lg hover:bg-indigo-700 transition-colors">
                                ê¸°ë¡ ì¡°íšŒí•˜ê¸°
                            </button>
                        </div>
                    </div>
                </div>
            `;
            // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œ Lucide ì•„ì´ì½˜ ë‹¤ì‹œ ìƒì„±
            lucide.createIcons();
        }

        // H. í† ìŠ¤íŠ¸ ì•Œë¦¼ í‘œì‹œ
        function showToast(message) {
            const toastRoot = document.getElementById('toast-root');
            toastRoot.innerHTML = `<div id="live-toast" class="toast">${message}</div>`;
            const toast = document.getElementById('live-toast');
            
            // í† ìŠ¤íŠ¸ í‘œì‹œ
            setTimeout(() => {
                toast.classList.add('show');
            }, 10); // ì•½ê°„ì˜ ì§€ì—° í›„ í‘œì‹œ

            // 2ì´ˆ í›„ ìˆ¨ê¹€
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
            
            // 2.3ì´ˆ í›„ DOMì—ì„œ ì œê±° (í´ë¦°ì—…)
            setTimeout(() => {
                toastRoot.innerHTML = '';
            }, 2300);
        }

        // =========================================================================
        // 4. Event & State Logic (ì´ë²¤íŠ¸ ì²˜ë¦¬)
        // =========================================================================

        // ìƒíƒœ ì—…ë°ì´íŠ¸ ë° ë Œë”ë§
        function updateState(key, value) {
            state[key] = value;
            if (key === 'activeTab') {
                // íƒ­ ë³€ê²½ ì‹œ í•„í„° ì´ˆê¸°í™”
                state.activePeriod = 'weekly';
                state.activeCategory = 'ì „ì²´';
                state.activeSort = 'ìµœì‹ ìˆœ'; 
            }
            render();
        }
        
        // ëª¨ë‹¬ ì—´ê¸°
        function openModal() {
            if (state.activeTab === 'rankboard') {
                state.isModalOpen = true;
                renderModal();
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            state.isModalOpen = false;
            renderModal();
        }
        
        // íˆ¬í‘œ ì²˜ë¦¬ í•¨ìˆ˜
        function handleVoteClick(productId) {
            // ë­í¬ë³´ë“œì—ì„œëŠ” íˆ¬í‘œ ë¶ˆê°€
            if (state.activeTab === 'rankboard') return;

            // 1. Mock Data ì—…ë°ì´íŠ¸ (ì ìˆ˜ ì¦ê°€)
            const productIndex = mockProducts.findIndex(p => p.id === productId);
            if (productIndex > -1) {
                mockProducts[productIndex].votes += 1; // 1ì  ì¶”ê°€
            }
            
            // 2. UI ì—…ë°ì´íŠ¸
            // íˆ¬í‘œ ìˆ˜ë§Œ ì—…ë°ì´íŠ¸í•˜ê³  ê¹œë¹¡ì„ íš¨ê³¼ë¥¼ ì£¼ê¸° ìœ„í•´ DOM ìš”ì†Œë¥¼ ì§ì ‘ ì¡°ì‘
            const voteCountEl = document.getElementById(`vote-count-${productId}`);
            const upvoteIconEl = document.getElementById(`upvote-icon-${productId}`);
            
            if (voteCountEl && upvoteIconEl) {
                voteCountEl.textContent = mockProducts[productIndex].votes.toLocaleString();
                
                // ì• ë‹ˆë©”ì´ì…˜ íš¨ê³¼ (ì•„ì´ì½˜ ê¹œë¹¡ì„)
                upvoteIconEl.classList.add('upvote-flash');
                setTimeout(() => {
                    upvoteIconEl.classList.remove('upvote-flash');
                }, 300);
            }

            // 3. ì‚¬ìš©ì ì•Œë¦¼ (í† ìŠ¤íŠ¸)
            showToast('íˆ¬í‘œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! +1ì  ğŸš€');
        }


        // ì´ˆê¸° ë¡œë“œ ì‹œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° (DOMì´ ìƒˆë¡œ ë Œë”ë§ëœ í›„ ì‹¤í–‰)
        function attachEventListeners() {
            // ë­í¬ë³´ë“œ ë‚ ì§œ ì˜ì—­ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸° ì´ë²¤íŠ¸ ì—°ê²°
            const dateTrigger = document.getElementById('date-picker-trigger');
            if (dateTrigger) {
                dateTrigger.addEventListener('click', openModal);
            }
        }

        // =========================================================================
        // 5. Initialization (ì´ˆê¸° ì‹¤í–‰)
        // =========================================================================
        render();

    </script>
</body>
</html>