<div class="admin-container">
    <!-- 헤더 -->
    <div class="admin-header">
        <h1>출시 일정 관리</h1>
        <p>등록된 모든 제품 출시 일정을 확인하고 관리하세요</p>
    </div>

    <!-- 통계 카드 -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-card-title">전체 출시 일정</span>
                <div class="stat-card-icon blue">
                    <i class="fas fa-calendar"></i>
                </div>
            </div>
            <div class="stat-card-value"><%= Launch.count %></div>
        </div>

        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-card-title">오늘 출시</span>
                <div class="stat-card-icon green">
                    <i class="fas fa-rocket"></i>
                </div>
            </div>
            <div class="stat-card-value"><%= Launch.where('DATE(launch_date) = ?', Date.current).count %></div>
        </div>

        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-card-title">예정된 출시</span>
                <div class="stat-card-icon orange">
                    <i class="fas fa-clock"></i>
                </div>
            </div>
            <div class="stat-card-value"><%= Launch.where('launch_date > ?', Time.current).count %></div>
        </div>

        <div class="stat-card">
            <div class="stat-card-header">
                <span class="stat-card-title">지난 출시</span>
                <div class="stat-card-icon purple">
                    <i class="fas fa-check-circle"></i>
                </div>
            </div>
            <div class="stat-card-value"><%= Launch.where('launch_date < ?', Time.current).count %></div>
        </div>
    </div>

    <!-- 출시 일정 목록 -->
    <div class="admin-section">
        <div class="admin-section-header">
            <h3 class="admin-section-title">출시 일정 목록</h3>
            <%= link_to new_admin_launch_path, class: "btn btn-primary" do %>
                <i class="fas fa-plus"></i> 새 일정 등록
            <% end %>
        </div>

        <!-- 검색 및 필터 -->
        <div class="search-filter-bar">
            <%= form_with url: admin_launches_path, method: :get, local: true, style: "display: flex; gap: 12px; width: 100%;" do |f| %>
                <%= f.select :status,
                    options_for_select([
                        ['모든 상태', ''],
                        ['예정', 'scheduled'],
                        ['진행중', 'active'],
                        ['완료', 'completed']
                    ], params[:status]),
                    {},
                    class: "filter-select" %>

                <%= f.select :date_filter,
                    options_for_select([
                        ['전체 기간', ''],
                        ['오늘', 'today'],
                        ['예정', 'upcoming'],
                        ['지난', 'past']
                    ], params[:date_filter]),
                    {},
                    class: "filter-select" %>

                <%= f.submit "필터 적용", class: "btn btn-primary" %>
                <%= link_to "초기화", admin_launches_path, class: "btn btn-secondary" %>
            <% end %>
        </div>

        <!-- 출시 일정 테이블 -->
        <table class="admin-table">
            <thead>
                <tr>
                    <th>제품</th>
                    <th>출시일</th>
                    <th>지역</th>
                    <th>상태</th>
                    <th>설명</th>
                    <th>등록일</th>
                    <th style="text-align: center;">액션</th>
                </tr>
            </thead>
            <tbody>
                <% @launches.each do |launch| %>
                    <tr>
                        <td>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <% if launch.product.logo_url.present? %>
                                    <img src="<%= launch.product.logo_url %>" alt="<%= launch.product.name %>" class="product-thumbnail">
                                <% else %>
                                    <div class="product-thumbnail" style="background: #f5f5f5; display: flex; align-items: center; justify-content: center;">
                                        <i class="fas fa-image" style="color: #ccc;"></i>
                                    </div>
                                <% end %>
                                <div>
                                    <%= link_to launch.product.name, admin_product_path(launch.product), class: "product-name" %>
                                    <% if launch.product.tagline.present? %>
                                        <div style="font-size: 12px; color: #999; margin-top: 2px;">
                                            <%= truncate(launch.product.tagline, length: 40) %>
                                        </div>
                                    <% end %>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div style="font-size: 13px; color: #333;">
                                <%= launch.launch_date.strftime('%Y년 %m월 %d일') %>
                            </div>
                            <div style="font-size: 11px; color: #999; margin-top: 2px;">
                                <%= launch.launch_date.strftime('%H:%M') %>
                            </div>
                        </td>
                        <td>
                            <span class="topic-tag" style="background: #e3f2fd; color: #1976d2;">
                                <i class="fas fa-globe"></i> <%= launch.region %>
                            </span>
                        </td>
                        <td>
                            <span class="status-badge <%= launch.status %>">
                                <%= launch.status.titleize %>
                            </span>
                        </td>
                        <td style="font-size: 13px; color: #666;">
                            <%= truncate(launch.description, length: 50) if launch.description.present? %>
                        </td>
                        <td style="font-size: 13px; color: #666;">
                            <%= time_ago_in_words(launch.created_at) %> 전
                        </td>
                        <td>
                            <div class="action-buttons" style="justify-content: center;">
                                <%= link_to admin_launch_path(launch), class: "btn btn-secondary btn-small", title: "상세" do %>
                                    <i class="fas fa-eye"></i>
                                <% end %>
                                <%= link_to edit_admin_launch_path(launch), class: "btn btn-primary btn-small", title: "수정" do %>
                                    <i class="fas fa-edit"></i>
                                <% end %>
                                <%= button_to admin_launch_path(launch), method: :delete, class: "btn btn-danger btn-small", title: "삭제", form: { data: { turbo_confirm: "정말 삭제하시겠습니까?" } } do %>
                                    <i class="fas fa-trash"></i>
                                <% end %>
                            </div>
                        </td>
                    </tr>
                <% end %>
            </tbody>
        </table>

        <!-- 페이지네이션 -->
        <% if @launches.respond_to?(:total_pages) && @launches.total_pages > 1 %>
            <div class="pagination">
                <%= link_to_unless @launches.first_page?, "‹ 이전", admin_launches_path(page: @launches.prev_page, status: params[:status], date_filter: params[:date_filter]), class: "page-link" %>

                <% (1..@launches.total_pages).each do |page| %>
                    <%= link_to page, admin_launches_path(page: page, status: params[:status], date_filter: params[:date_filter]), class: "page-link #{page == @launches.current_page ? 'active' : ''}" %>
                <% end %>

                <%= link_to_unless @launches.last_page?, "다음 ›", admin_launches_path(page: @launches.next_page, status: params[:status], date_filter: params[:date_filter]), class: "page-link" %>
            </div>
        <% end %>
    </div>
</div>
