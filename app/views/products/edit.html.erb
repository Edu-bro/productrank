<!-- ì œí’ˆ ë“±ë¡ í˜ì´ì§€ ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
<style>
.product-form-container {
  max-width: 900px;
  margin: 0 auto;
  padding: 2rem 1rem;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

.form-header {
  text-align: center;
  margin-bottom: 3rem;
}

.form-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: #1a1a1a;
  margin-bottom: 0.5rem;
}

.form-subtitle {
  font-size: 1.1rem;
  color: #666;
}

.form-section {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  border: 1px solid #e5e5e5;
}

.section-title {
  font-size: 1.3rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 1.5rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.section-icon {
  width: 20px;
  height: 20px;
  color: #666;
}

.form-group {
  margin-bottom: 1.5rem;
}

.form-label {
  display: block;
  font-weight: 500;
  color: #333;
  margin-bottom: 0.5rem;
  font-size: 0.95rem;
}

.required {
  color: #ff6b35;
}

.form-input, .form-textarea, .form-select {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid #e5e5e5;
  border-radius: 8px;
  font-size: 1rem;
  transition: border-color 0.2s ease;
  background: #fafafa;
}

.form-input:focus, .form-textarea:focus, .form-select:focus {
  outline: none;
  border-color: #ff6b35;
  background: white;
  box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);
}

.form-help {
  font-size: 0.85rem;
  color: #666;
  margin-top: 0.25rem;
}

.key-features-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.topics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 0.75rem;
}

.topic-checkbox {
  display: flex;
  align-items: center;
  padding: 0.75rem;
  border: 2px solid #e5e5e5;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
  background: #fafafa;
}

.topic-checkbox:hover {
  border-color: #ff6b35;
  background: white;
}

.topic-checkbox input:checked + .topic-label {
  color: #ff6b35;
  font-weight: 600;
}

.topic-checkbox input:checked {
  accent-color: #ff6b35;
}

.topic-label {
  margin-left: 0.5rem;
  font-size: 0.9rem;
  color: #333;
}

/* íŒŒì¼ ì—…ë¡œë“œ ìŠ¤íƒ€ì¼ */
.upload-area {
  border: 2px dashed #d1d5db;
  border-radius: 12px;
  padding: 2rem;
  text-align: center;
  background: #fafafa;
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
}

.upload-area:hover, .upload-area.dragover {
  border-color: #ff6b35;
  background: #fff8f5;
}

.upload-icon {
  width: 3rem;
  height: 3rem;
  margin: 0 auto 1rem;
  color: #9ca3af;
}

.upload-text {
  font-size: 1.1rem;
  color: #374151;
  margin-bottom: 0.5rem;
}

.upload-subtext {
  font-size: 0.9rem;
  color: #6b7280;
}

.file-input {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  cursor: pointer;
}

.image-preview {
  margin-top: 1rem;
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}

.preview-item {
  position: relative;
  width: 100px;
  height: 100px;
  border-radius: 8px;
  overflow: hidden;
  border: 2px solid #e5e5e5;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.remove-image {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border: none;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
}

.form-actions {
  display: flex;
  gap: 1rem;
  justify-content: space-between;
  align-items: center;
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 2px solid #f0f0f0;
}

.btn {
  padding: 0.75rem 2rem;
  border-radius: 8px;
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
  border: none;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
}

.btn-primary {
  background: #ff6b35;
  color: white;
}

.btn-primary:hover {
  background: #e55a2b;
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(255, 107, 53, 0.3);
}

.btn-secondary {
  background: #f8f9fa;
  color: #666;
  border: 2px solid #e5e5e5;
}

.btn-secondary:hover {
  background: #e9ecef;
  border-color: #ccc;
}

.error-list {
  background: #fee2e2;
  border: 1px solid #fecaca;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 2rem;
}

.error-title {
  color: #dc2626;
  font-weight: 600;
  margin-bottom: 0.5rem;
}

.error-item {
  color: #b91c1c;
  font-size: 0.9rem;
}

/* íŒ€ì› ê²€ìƒ‰ ë° ê´€ë¦¬ ìŠ¤íƒ€ì¼ */
.team-member-search {
  position: relative;
}

.search-results {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: white;
  border: 2px solid #e5e5e5;
  border-top: none;
  border-radius: 0 0 8px 8px;
  max-height: 250px;
  overflow-y: auto;
  z-index: 10;
  display: none;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.search-results.empty {
  padding: 1rem;
  text-align: center;
  color: #94a3b8;
}

.search-result-item {
  padding: 0.75rem 1rem;
  cursor: pointer;
  border-bottom: 1px solid #f0f0f0;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  transition: background 0.2s;
}

.search-result-item:hover {
  background: #f0f7ff;
  border-left: 3px solid #3b82f6;
  padding-left: calc(1rem - 3px);
}

.search-result-item:last-child {
  border-bottom: none;
}

.search-result-name {
  font-weight: 600;
  color: #1e293b;
}

.search-result-email {
  font-size: 0.85rem;
  color: #64748b;
}

.team-member-card {
  background: #f8f9fa;
  border: 2px solid #e5e5e5;
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}

.team-member-info {
  flex: 1;
}

.team-member-name {
  font-weight: 600;
  color: #333;
  margin-bottom: 0.5rem;
}

.team-member-inputs {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.75rem;
  margin-top: 0.5rem;
}

.team-member-inputs input {
  padding: 0.5rem;
  border: 1px solid #ddd;
  border-radius: 4px;
  font-size: 0.9rem;
}

.remove-member {
  background: #dc3545;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 0.5rem 1rem;
  cursor: pointer;
  font-size: 0.85rem;
}

.remove-member:hover {
  background: #c82333;
}

@media (max-width: 768px) {
  .product-form-container {
    padding: 1rem;
  }
  
  .form-section {
    padding: 1.5rem;
  }
  
  .key-features-grid, .topics-grid {
    grid-template-columns: 1fr;
  }
  
  .team-member-inputs {
    grid-template-columns: 1fr;
  }
  
  .form-actions {
    flex-direction: column;
    gap: 1rem;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
}
</style>

<div class="product-form-container">
  <div class="form-header">
    <h1 class="form-title"><%= @product.name %> í¸ì§‘</h1>
    <p class="form-subtitle">ì œí’ˆ ì •ë³´ë¥¼ ìˆ˜ì •í•˜ì„¸ìš”</p>
  </div>

  <% if @product.errors.any? %>
    <div class="error-list">
      <div class="error-title">âš ï¸ ì…ë ¥ ì˜¤ë¥˜ê°€ ìˆìŠµë‹ˆë‹¤</div>
      <ul>
        <% @product.errors.full_messages.each do |message| %>
          <li class="error-item"><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with model: @product, local: true, multipart: true do |form| %>
    <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        ê¸°ë³¸ ì •ë³´
      </h2>

      <div class="form-group">
        <%= form.label :name, class: "form-label" do %>
          ì œí’ˆëª… <span class="required">*</span>
        <% end %>
        <%= form.text_field :name, class: "form-input", placeholder: "ì˜ˆ: Notion" %>
      </div>

      <div class="form-group">
        <%= form.label :tagline, class: "form-label" do %>
          ì œí’ˆ í•œì¤„ì†Œê°œ <span class="required">*</span>
        <% end %>
        <%= form.text_field :tagline, class: "form-input", placeholder: "ì˜ˆ: ì˜¬ì¸ì› ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¡œ ë…¸íŠ¸, ì‘ì—…, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í•˜ë‚˜ë¡œ" %>
        <p class="form-help">ìµœëŒ€ 60ì</p>
      </div>

      <div class="form-group">
        <%= form.label :description, class: "form-label" do %>
          ì œí’ˆ ì„¤ëª… <span class="required">*</span>
        <% end %>
        <%= form.text_area :description, rows: 4, class: "form-textarea", placeholder: "ì œí’ˆì˜ ì£¼ìš” ê¸°ëŠ¥ê³¼ íŠ¹ì§•ì„ ìì„¸íˆ ì„¤ëª…í•´ì£¼ì„¸ìš”..." %>
        <p class="form-help">ìµœëŒ€ 500ì</p>
      </div>

      <div class="form-group">
        <%= form.label :website_url, "ì›¹ì‚¬ì´íŠ¸ URL", class: "form-label" %>
        <%= form.text_field :website_url, class: "form-input", placeholder: "naver.com ë˜ëŠ” https://notion.so" %>
        <p class="form-help">ì›¹ì‚¬ì´íŠ¸ ì£¼ì†Œë¥¼ ììœ ë¡­ê²Œ ì…ë ¥í•˜ì„¸ìš” (http://ëŠ” ìë™ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤)</p>
      </div>
    </div>

    <!-- ì£¼ìš” ê¸°ëŠ¥ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        ì£¼ìš” ê¸°ëŠ¥
      </h2>
      <p class="form-help" style="margin-bottom: 1rem;">ì œí’ˆì˜ í•µì‹¬ ê¸°ëŠ¥ì„ ìµœëŒ€ 5ê°œê¹Œì§€ ì…ë ¥í•˜ì„¸ìš” (ê° ê¸°ëŠ¥ë‹¹ 15ì ì´ë‚´)</p>
      
      <div class="key-features-grid">
        <%
          # ê¸°ì¡´ ì£¼ìš” ê¸°ëŠ¥ ê°€ì ¸ì˜¤ê¸°
          existing_features = @product.key_features_list
        %>
        <% 5.times do |i| %>
          <div class="form-group">
            <%= label_tag "key_features_#{i}", "ê¸°ëŠ¥ #{i + 1}", class: "form-label" %>
            <%= text_field_tag "key_features[]", existing_features[i] || "",
                  class: "form-input",
                  placeholder: "ì˜ˆ: ì‹¤ì‹œê°„ í˜‘ì—…",
                  maxlength: 15 %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z"/>
        </svg>
        ì´ë¯¸ì§€ ì—…ë¡œë“œ
      </h2>

      <!-- ë¡œê³  ì—…ë¡œë“œ -->
      <div class="form-group">
        <%= form.label :logo_image, "ì œí’ˆ ë¡œê³ ", class: "form-label" %>
        <p class="form-help" style="margin-bottom: 1rem;">ì •ì‚¬ê°í˜• ë¹„ìœ¨ ê¶Œì¥ (PNG, JPG, ìµœëŒ€ 1MB)</p>

        <% if @product.logo_image.attached? %>
          <div style="margin-bottom: 1rem;">
            <p style="color: #10b981; font-size: 0.9rem; margin-bottom: 0.5rem;">âœ“ í˜„ì¬ ë¡œê³  ì´ë¯¸ì§€:</p>
            <div style="display: inline-block; border: 2px solid #e5e5e5; border-radius: 8px; padding: 0.5rem;">
              <img src="<%= @product.logo_thumb_1x %>" alt="í˜„ì¬ ë¡œê³ " style="width: 100px; height: 100px; object-fit: cover; border-radius: 4px;">
            </div>
            <p style="color: #666; font-size: 0.85rem; margin-top: 0.5rem;">ìƒˆ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ê¸°ì¡´ ë¡œê³ ê°€ êµì²´ë©ë‹ˆë‹¤</p>
          </div>
        <% end %>

        <div class="upload-area" id="logo-upload">
          <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
          </svg>
          <div class="upload-text"><%= @product.logo_image.attached? ? "ìƒˆ ë¡œê³  ì—…ë¡œë“œ" : "ë¡œê³  ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒ" %></div>
          <div class="upload-subtext">PNG, JPG ê¶Œì¥ (ìµœëŒ€ 1MB)</div>
          <%= form.file_field :logo_image, class: "file-input", accept: "image/*" %>
        </div>
        <div id="logo-preview" class="image-preview"></div>
      </div>

      <!-- ì œí’ˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ (í†µí•©) -->
      <div class="form-group">
        <%= form.label :product_images, "ì œí’ˆ ì´ë¯¸ì§€", class: "form-label" do %>
          ì œí’ˆ ì´ë¯¸ì§€ <span class="required">*</span>
        <% end %>
        <p class="form-help" style="margin-bottom: 1rem;">
          ğŸ“¸ ì—¬ëŸ¬ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”. <strong>ì²« ë²ˆì§¸ ì´ë¯¸ì§€ê°€ ì¸ë„¤ì¼(ì»¤ë²„ ì´ë¯¸ì§€)</strong>ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤.<br>
          ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ê°ê° ìµœëŒ€ 1MB)
        </p>

        <% if @product.product_images.attached? %>
          <div style="margin-bottom: 1rem;">
            <p style="color: #10b981; font-size: 0.9rem; margin-bottom: 0.5rem;">âœ“ í˜„ì¬ ì œí’ˆ ì´ë¯¸ì§€ (<%= @product.product_images.count %>ê°œ):</p>
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 0.5rem;">
              <% @product.product_images.each_with_index do |image, index| %>
                <div style="position: relative; border: 2px solid <%= index == 0 ? '#ff6b35' : '#e5e5e5' %>; border-radius: 8px; padding: 0.25rem;">
                  <% if index == 0 %>
                    <div style="position: absolute; top: -8px; left: 50%; transform: translateX(-50%); background: #ff6b35; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; white-space: nowrap;">ì¸ë„¤ì¼</div>
                  <% end %>
                  <img src="<%= rails_blob_path(image, only_path: true) %>" alt="ì œí’ˆ ì´ë¯¸ì§€ <%= index + 1 %>" style="width: 100px; height: 100px; object-fit: cover; border-radius: 4px;">
                  <div style="text-align: center; font-size: 0.7rem; color: #666; margin-top: 0.25rem;"><%= index + 1 %>ë²ˆ</div>
                </div>
              <% end %>
            </div>
            <p style="color: #666; font-size: 0.85rem;">ìƒˆ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ë©´ ê¸°ì¡´ ì´ë¯¸ì§€ê°€ ëª¨ë‘ êµì²´ë©ë‹ˆë‹¤</p>
          </div>
        <% end %>

        <div class="upload-area" id="product-images-upload">
          <svg class="upload-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
          </svg>
          <div class="upload-text"><%= @product.product_images.attached? ? "ìƒˆ ì œí’ˆ ì´ë¯¸ì§€ ì—…ë¡œë“œ" : "ì œí’ˆ ì´ë¯¸ì§€ë“¤ì„ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì„ íƒ" %></div>
          <div class="upload-subtext">ì—¬ëŸ¬ íŒŒì¼ ì„ íƒ ê°€ëŠ¥ â€¢ ì²« ë²ˆì§¸ ì´ë¯¸ì§€ = ì¸ë„¤ì¼</div>
          <%= form.file_field :product_images, multiple: true, class: "file-input", accept: "image/*", id: "product-images-input" %>
        </div>
        <div id="product-images-preview" class="image-preview sortable-images"></div>
      </div>
    </div>

    <!-- ì¹´í…Œê³ ë¦¬ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
        </svg>
        ì¹´í…Œê³ ë¦¬ ì„ íƒ (ì¤‘ë³µì„ íƒ ìµœëŒ€ 3ê°œ)
      </h2>
      
      <div class="topics-grid" id="topics-grid">
        <% @topics.each do |topic| %>
          <label class="topic-checkbox">
            <%= check_box_tag 'topic_ids[]', topic.id, @product.topics.include?(topic), class: "" %>
            <span class="topic-label"><%= topic.name %></span>
          </label>
        <% end %>
      </div>
    </div>

    <!-- íŒ€ì› ì†Œê°œ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M9 12a2 2 0 100-4 2 2 0 000 4z M9 14s-6 3-6 6h12c0-3-6-6-6-6z"/>
        </svg>
        íŒ€ì› ì†Œê°œ
      </h2>
      
      <div id="team-members-container">
        <!-- íŒ€ì›ë“¤ì´ ì—¬ê¸°ì— ì¶”ê°€ë©ë‹ˆë‹¤ -->
      </div>
      
      <div class="form-group">
        <label class="form-label">íŒ€ì› ì¶”ê°€</label>
        <p class="form-help" style="margin-bottom: 0.5rem;">íŒ€ì›ì˜ ì´ë¦„ì´ë‚˜ ì´ë©”ì¼ì„ ì…ë ¥í•˜ì—¬ ê²€ìƒ‰í•˜ê³ , ê²°ê³¼ì—ì„œ ì„ íƒí•˜ì„¸ìš”</p>
        <div class="team-member-search">
          <input type="text" id="member-search" class="form-input" placeholder="ì˜ˆ: í™ê¸¸ë™ ë˜ëŠ” hong@example.com" autocomplete="off">
          <div id="search-results" class="search-results"></div>
        </div>
        <p class="form-help" style="margin-top: 0.5rem; color: #94a3b8;">ğŸ’¡ ìµœì†Œ 2ê¸€ì ì´ìƒ ì…ë ¥í•˜ë©´ ê²€ìƒ‰ ê²°ê³¼ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤</p>
      </div>
    </div>

    <!-- íšŒì‚¬ ì •ë³´ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path d="M4 4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2H4zm0 2h12v10H4V6z"/>
        </svg>
        íšŒì‚¬ ì •ë³´ (ì„ íƒì‚¬í•­)
      </h2>

      <div class="form-group">
        <%= form.label :company_name, "íšŒì‚¬ëª…", class: "form-label" %>
        <%= form.text_field :company_name, class: "form-input", placeholder: "ì˜ˆ: Notion Labs Inc." %>
      </div>

      <div class="form-group">
        <%= form.label :company_description, "íšŒì‚¬ ì†Œê°œ", class: "form-label" %>
        <%= form.text_area :company_description, rows: 3, class: "form-textarea", placeholder: "íšŒì‚¬ì˜ ë¹„ì „, ë¯¸ì…˜, ì£¼ìš” ì‚¬ì—… ë“±ì„ ê°„ë‹¨íˆ ì†Œê°œí•´ì£¼ì„¸ìš”..." %>
        <p class="form-help">ìµœëŒ€ 200ì</p>
      </div>

      <div class="form-group">
        <%= form.label :founded_year, "ì„¤ë¦½ì—°ë„", class: "form-label" %>
        <%= form.number_field :founded_year, class: "form-input", placeholder: "ì˜ˆ: 2016", min: 1800, max: Date.current.year %>
      </div>

      <div class="form-group">
        <%= form.label :headquarters, "ë³¸ì‚¬ ìœ„ì¹˜", class: "form-label" %>
        <%= form.text_field :headquarters, class: "form-input", placeholder: "ì˜ˆ: ìƒŒí”„ë€ì‹œìŠ¤ì½”, ë¯¸êµ­" %>
      </div>

      <div class="form-group">
        <%= form.label :employee_count, "ì§ì› ìˆ˜", class: "form-label" %>
        <%= form.text_field :employee_count, class: "form-input", placeholder: "ì˜ˆ: 200-500ëª…" %>
        <p class="form-help">ì§ì› ìˆ˜ ë²”ìœ„ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 10-50ëª…, 100-200ëª…)</p>
      </div>

      <div style="border-top: 1px solid #e5e5e5; margin: 1.5rem 0; padding-top: 1.5rem;">
        <h3 style="font-size: 1rem; font-weight: 600; color: #333; margin-bottom: 1rem;">ì†Œì…œ ë¯¸ë””ì–´</h3>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
          <div class="form-group">
            <%= form.label :facebook_url, "Facebook", class: "form-label" %>
            <%= form.text_field :facebook_url, class: "form-input", placeholder: "facebook.com/yourpage" %>
          </div>

          <div class="form-group">
            <%= form.label :instagram_url, "Instagram", class: "form-label" %>
            <%= form.text_field :instagram_url, class: "form-input", placeholder: "instagram.com/yourpage" %>
          </div>

          <div class="form-group">
            <%= form.label :tiktok_url, "TikTok", class: "form-label" %>
            <%= form.text_field :tiktok_url, class: "form-input", placeholder: "tiktok.com/@yourpage" %>
          </div>

          <div class="form-group">
            <%= form.label :github_url, "GitHub", class: "form-label" %>
            <%= form.text_field :github_url, class: "form-input", placeholder: "github.com/yourorg" %>
          </div>
        </div>
      </div>
    </div>

    <!-- íŠ¹ë³„ í˜œíƒ ì„¹ì…˜ -->
    <div class="form-section">
      <h2 class="section-title">
        <svg class="section-icon" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M5 2a1 1 0 011 1v1h1a1 1 0 010 2H6v1a1 1 0 01-2 0V6H3a1 1 0 010-2h1V3a1 1 0 011-1zm0 10a1 1 0 011 1v1h1a1 1 0 110 2H6v1a1 1 0 11-2 0v-1H3a1 1 0 110-2h1v-1a1 1 0 011-1zM12 2a1 1 0 01.967.744L14.146 7.2 17.5 9.134a1 1 0 010 1.732l-3.354 1.935-1.18 4.455a1 1 0 01-1.933 0L9.854 12.8 6.5 10.866a1 1 0 010-1.732l3.354-1.935 1.18-4.455A1 1 0 0112 2z" clip-rule="evenodd"/>
        </svg>
        íŠ¹ë³„ í˜œíƒ
      </h2>

      <div class="form-group">
        <%= form.label :pricing_info, "ì œê³µ ê°€ëŠ¥í•œ í˜œíƒ ë° íŠ¹ì§•", class: "form-label" %>
        <%= form.text_area :pricing_info, rows: 4, class: "form-textarea",
              placeholder: "â€¢ ë¬´ë£Œ ì²´í—˜ 14ì¼ ì œê³µ\nâ€¢ ë¬´ì œí•œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤\nâ€¢ 24/7 ê³ ê° ì§€ì›\nâ€¢ API ì—°ë™ ì§€ì›" %>
        <p class="form-help">ProductRank ì°¸ì—¬ìì—ê²Œ ì œê³µ ê°€ëŠ¥í•œ ì œí’ˆì˜ ì£¼ìš” í˜œíƒì´ë‚˜ íŠ¹ë³„í•œ íŠ¹ì§•ë“¤ì„ ì…ë ¥í•˜ì„¸ìš”</p>
      </div>
    </div>

    <!-- ë²„íŠ¼ -->
    <div class="form-actions">
      <%= link_to "ì·¨ì†Œ", @product, class: "btn btn-secondary" %>
      <%= form.submit "ìˆ˜ì • ì™„ë£Œ", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>

<!-- JavaScript for file upload preview and other features -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // íŒŒì¼ ì—…ë¡œë“œ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
  function setupFileUpload(uploadId, previewId, multiple = false) {
    const uploadArea = document.getElementById(uploadId);
    const fileInput = uploadArea.querySelector('input[type="file"]');
    const preview = document.getElementById(previewId);

    // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ì´ë²¤íŠ¸
    ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
      uploadArea.addEventListener(eventName, preventDefaults, false);
    });

    function preventDefaults(e) {
      e.preventDefault();
      e.stopPropagation();
    }

    ['dragenter', 'dragover'].forEach(eventName => {
      uploadArea.addEventListener(eventName, () => uploadArea.classList.add('dragover'), false);
    });

    ['dragleave', 'drop'].forEach(eventName => {
      uploadArea.addEventListener(eventName, () => uploadArea.classList.remove('dragover'), false);
    });

    uploadArea.addEventListener('drop', handleDrop, false);

    function handleDrop(e) {
      const files = e.dataTransfer.files;
      if (multiple) {
        fileInput.files = files;
      } else {
        if (files.length > 0) {
          const dt = new DataTransfer();
          dt.items.add(files[0]);
          fileInput.files = dt.files;
        }
      }
      handleFiles(fileInput.files);
    }

    // íŒŒì¼ ì„ íƒ ì´ë²¤íŠ¸
    fileInput.addEventListener('change', () => handleFiles(fileInput.files));

    function handleFiles(files) {
      preview.innerHTML = '';
      const MAX_FILE_SIZE = 1 * 1024 * 1024; // 1MB in bytes
      let hasOversizedFile = false;

      [...files].forEach(file => {
        if (file.type.startsWith('image/')) {
          // Check file size
          if (file.size > MAX_FILE_SIZE) {
            hasOversizedFile = true;
            const fileSizeMB = (file.size / (1024 * 1024)).toFixed(2);
            alert(`íŒŒì¼ "${file.name}"ì˜ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤ (${fileSizeMB}MB).\nê° ì´ë¯¸ì§€ëŠ” ìµœëŒ€ 1MBê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
            return;
          }

          const reader = new FileReader();
          reader.onload = function(e) {
            const div = document.createElement('div');
            div.className = 'preview-item';
            div.innerHTML = `
              <img src="${e.target.result}" alt="ë¯¸ë¦¬ë³´ê¸°" class="preview-image">
              <button type="button" class="remove-image" onclick="this.parentElement.remove()">Ã—</button>
            `;
            preview.appendChild(div);
          };
          reader.readAsDataURL(file);
        }
      });

      // Clear file input if any file was oversized
      if (hasOversizedFile) {
        fileInput.value = '';
      }
    }
  }

  // ê° íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ ì„¤ì •
  setupFileUpload('logo-upload', 'logo-preview');
  setupFileUpload('product-images-upload', 'product-images-preview', true);

  // ì¹´í…Œê³ ë¦¬ ì„ íƒ ì œí•œ (ìµœëŒ€ 3ê°œ)
  const topicsGrid = document.getElementById('topics-grid');
  const checkboxes = topicsGrid.querySelectorAll('input[type="checkbox"]');
  
  checkboxes.forEach(checkbox => {
    checkbox.addEventListener('change', function() {
      const checkedBoxes = topicsGrid.querySelectorAll('input[type="checkbox"]:checked');
      if (checkedBoxes.length > 3) {
        this.checked = false;
        alert('ìµœëŒ€ 3ê°œì˜ ì¹´í…Œê³ ë¦¬ë§Œ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
      }
    });
  });

  // íŒ€ì› ê²€ìƒ‰ ê¸°ëŠ¥
  const memberSearch = document.getElementById('member-search');
  const searchResults = document.getElementById('search-results');
  const teamMembersContainer = document.getElementById('team-members-container');
  let searchTimeout;
  let addedMembers = new Set();

  memberSearch.addEventListener('input', function() {
    const query = this.value.trim();
    console.log('âŒ¨ï¸ Input event - Query:', query, 'Length:', query.length);

    clearTimeout(searchTimeout);

    if (query.length >= 2) {
      console.log('âœ¨ Query Ğ´Ğ»Ğ¸Ğ½Ñ‹ Ğ´Ğ¾ÑÑ‚Ğ°Ñ‚Ğ¾Ñ‡Ğ½Ğ¾, Ğ¿Ğ¾Ğ¸ÑĞº Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½ Ñ‡ĞµÑ€ĞµĞ· 300ms');
      searchTimeout = setTimeout(() => searchUsers(query), 300);
    } else {
      console.log('â¸ Query ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹, ÑĞºÑ€Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹');
      hideSearchResults();
    }
  });

  memberSearch.addEventListener('blur', function() {
    setTimeout(() => hideSearchResults(), 200);
  });

  function searchUsers(query) {
    console.log('ğŸ” Searching for:', query);
    // ì‹¤ì œ API í˜¸ì¶œë¡œ ì‚¬ìš©ì ê²€ìƒ‰
    fetch(`/users/search?q=${encodeURIComponent(query)}`)
      .then(response => {
        console.log('âœ… Search response received:', response.status);
        return response.json();
      })
      .then(users => {
        console.log('ğŸ‘¥ Users found:', users);
        displaySearchResults(users);
      })
      .catch(error => {
        console.error('âŒ User search error:', error);
        displaySearchResults([]);
      });
  }

  function displaySearchResults(users) {
    if (users.length === 0) {
      // ê²€ìƒ‰í–ˆì§€ë§Œ ê²°ê³¼ ì—†ìŒ
      searchResults.innerHTML = '<div class="empty">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì´ë¦„ì´ë‚˜ ì´ë©”ì¼ì„ ì…ë ¥í•´ë³´ì„¸ìš”.</div>';
      searchResults.classList.add('empty');
      searchResults.style.display = 'block';
      return;
    }

    searchResults.classList.remove('empty');
    const resultsHtml = users.map(user => `
      <div class="search-result-item" data-user-id="${user.id}" data-user-name="${escapeHtml(user.name)}" data-user-email="${escapeHtml(user.email)}">
        <div class="search-result-name">${escapeHtml(user.name)}</div>
        <div class="search-result-email">${escapeHtml(user.email)}</div>
      </div>
    `).join('');

    searchResults.innerHTML = resultsHtml;
    searchResults.style.display = 'block';

    // ê²€ìƒ‰ ê²°ê³¼ í´ë¦­ ì´ë²¤íŠ¸
    searchResults.querySelectorAll('.search-result-item').forEach(item => {
      item.addEventListener('click', function() {
        const userId = this.dataset.userId;
        const userName = this.dataset.userName;
        const userEmail = this.dataset.userEmail;

        if (addedMembers.has(userId)) {
          alert('ì´ë¯¸ ì¶”ê°€ëœ íŒ€ì›ì…ë‹ˆë‹¤.');
          return;
        }

        addTeamMember(userId, userName, userEmail);
        addedMembers.add(userId);

        memberSearch.value = '';
        hideSearchResults();

        // ì„±ê³µ í”¼ë“œë°±
        memberSearch.placeholder = 'íŒ€ì›ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ê³„ì† ê²€ìƒ‰í•˜ì„¸ìš”...';
        setTimeout(() => {
          memberSearch.placeholder = 'ì˜ˆ: í™ê¸¸ë™ ë˜ëŠ” hong@example.com';
        }, 2000);
      });
    });
  }

  // HTML escape function to prevent XSS
  function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
  }

  function hideSearchResults() {
    searchResults.style.display = 'none';
  }

  function addTeamMember(userId, userName, userEmail) {
    const memberCard = document.createElement('div');
    memberCard.className = 'team-member-card';
    memberCard.innerHTML = `
      <div class="team-member-info">
        <div class="team-member-name">
          âœ“ ${escapeHtml(userName)}
          <span style="color: #64748b; font-size: 0.85em; font-weight: normal;">(${escapeHtml(userEmail)})</span>
        </div>
        <p style="color: #10b981; font-size: 0.85rem; margin: 0.5rem 0; font-weight: 500;">
          âœ“ íŒ€ì›ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤. í¬ì§€ì…˜ê³¼ ì—­í• ì„ ì…ë ¥í•˜ì„¸ìš”.
        </p>
        <div class="team-member-inputs">
          <input type="text" placeholder="í¬ì§€ì…˜ (ì˜ˆ: CEO, CTO)" name="team_members[${userId}][position]" required>
          <input type="text" placeholder="ì£¼ìš” ì—­í•  (ì˜ˆ: ì œí’ˆê°œë°œ ì´ê´„)" name="team_members[${userId}][role]" required>
        </div>
        <input type="hidden" name="team_members[${userId}][user_id]" value="${userId}">
        <input type="hidden" name="team_members[${userId}][name]" value="${escapeHtml(userName)}">
        <p style="color: #64748b; font-size: 0.8rem; margin-top: 0.5rem;">
          ğŸ’¡ ì…ë ¥ í›„ ì•„ë˜ "ì œí’ˆ ë“±ë¡í•˜ê¸°" ë²„íŠ¼ì„ ëˆŒëŸ¬ ì œí’ˆê³¼ í•¨ê»˜ ì €ì¥ë©ë‹ˆë‹¤
        </p>
      </div>
      <button type="button" class="remove-member" onclick="removeTeamMember(this, '${userId}')">
        <i class="fas fa-times"></i>
      </button>
    `;

    teamMembersContainer.appendChild(memberCard);

    // ì¶”ê°€ ì• ë‹ˆë©”ì´ì…˜
    memberCard.style.opacity = '0';
    memberCard.style.transform = 'translateY(-10px)';
    setTimeout(() => {
      memberCard.style.transition = 'all 0.3s ease';
      memberCard.style.opacity = '1';
      memberCard.style.transform = 'translateY(0)';
    }, 10);
  }

  // ì „ì—­ í•¨ìˆ˜ë¡œ íŒ€ì› ì‚­ì œ ê¸°ëŠ¥
  window.removeTeamMember = function(button, userId) {
    button.closest('.team-member-card').remove();
    addedMembers.delete(userId);
  };
});
</script>